/* Write a function called clockKeeper() that takes as its argument a dateAndTime
structure as defined in this chapter. The function should call the timeUpdate() function, and if the time 
reaches midnight, the function should call the dateUpdate function to switch over
to the next day. Have the function return the updated dateAndTime structure.
** it should also account for end of month, end of year, and leap years. */

#include <stdio.h>
#include <stdbool.h>
#include <windows.management.update.h>




struct dateAndTime
{
	int day;
	int month;
	int year;
	int hour;
	int minutes;
	int seconds;
};

const int daysPerMonth[12] = { 31, 28, 31, 30, 31, 30,	// number of days in each month
						31, 31, 30, 31, 30, 31 };

struct dateAndTime currentTime, nextTime;

struct nextTime dateUpdate(struct currentTime)			// still working on this, but it 
														//is supposed to update the date if the time reaches midnight
{
	int numberOfDays(struct currentTime);

	if (currentTime.day != numberOfDays(currentTime.day))
	{
		nextTime = (struct dateAndTime){ currentTime.month, currentTime.day + 1, currentTime.year };
	}
	else if (currentTime.month == 12)	// end of year
	{
		nextTime = (struct dateAndTime){ 1, 1, currentTime.year + 1 };
	}
	else            // end of month
	{
		nextTime = (struct dateAndTime){ currentTime.month + 1, 1, currentTime.year };
	}

		return nextTime;
}



struct dateAndTime timeUpdate(struct dateAndTime now)		// function to update time by one second
{
	++now.seconds;

	if (now.seconds == 60)	// next minute
	{
		now.seconds = 0;
		++now.minutes;

		if (now.minutes == 60)	// next hour
		{
			now.minutes = 0;
			++now.hour;

			if (now.hour == 24)	// midnight
				now.hour = 0;
		}
	}
	return now;
}


int main(void)
{
	printf("Enter the time in military time (hh:mm:ss): \n");
	scanf_s("%i:%i:%i", &currentTime.hour, &currentTime.minutes,
		&currentTime.seconds);

	printf("Enter today's date (mm dd yyyy): \n");
	scanf_s("%i%i%i", &currentTime.month, &currentTime.day, &currentTime.year);

	struct dateAndTime timeUpdate(struct dateAndTime now);

	nextTime = timeUpdate(currentTime);

	printf("***One second from the time you put in is***\n");
	printf("Date: %i/%i/%.2i\n", nextTime.month, nextTime.day, nextTime.year);
	printf("Time: %i:%i:%i\n", nextTime.hour, nextTime.minutes, nextTime.seconds);
	
	
	return 0;

}
